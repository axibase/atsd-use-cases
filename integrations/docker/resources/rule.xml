<?xml version="1.0" encoding="UTF-8"?><rules>
<rule>
<name>dockerhub-build-fail</name>
<metric>message</metric>
<tags>type, source, repository, tags.dockertag_name</tags>
<tagsGroupingStrategy>DEFINED_TAGS</tagsGroupingStrategy>
<expression><![CDATA[elapsedTime(update_ms) < 24*60*60000
&& ( tags.status NOT IN ('0', '2', '3', '10') 
  || tags.status = '0' && (now.getMillis() - create_ms) > 60*60000 )]]></expression>
<window>length(1)</window>
<filter>type = 'build' &amp;&amp; source = 'docker.hub'</filter>
<severity>WARNING</severity>
<alertOpenMessage><![CDATA[${received_datetime}	${status}	${severity}	${rule}	${metric}	${entity.displayName}	${tags}	${value}]]></alertOpenMessage>
<alertMessage><![CDATA[${received_datetime}	${status}	${severity}	${rule}	${metric}	${entity.displayName}	${tags}	${value}]]></alertMessage>
<alertMessageAsOpen>true</alertMessageAsOpen>
<alertCancellationMessage><![CDATA[${received_datetime}	${status}	${severity}	${rule}	${metric}	${entity.displayName}	${tags}	${value}]]></alertCancellationMessage>
<alertCancellationMessageAsOpen>true</alertCancellationMessageAsOpen>
<alertStrategy>
<type>ALL</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</alertStrategy>
<userExpressions>
<expression><![CDATA[milliseconds(tags.created_date) AS create_ms]]></expression>
<expression><![CDATA[milliseconds(tags.last_updated) AS update_ms]]></expression>
<expression><![CDATA[tags.status AS st]]></expression>
<expression><![CDATA[st = '-1' ? 'Failed' : (st = '0' ? 'Queued' : (st = '3' ? 'Pending' : (st = '10' ? 'Completed' : st))) AS status_desc]]></expression>
<expression><![CDATA['https://hub.docker.com/r/' + tags.repository + '/builds/' + tags.build_code AS lnk]]></expression>
</userExpressions>
<lastUpdated>1524808089630</lastUpdated>
<enabled>true</enabled>
<disableEntityGrouping>false</disableEntityGrouping>
<leavingEvents>true</leavingEvents>
<loadHistory>false</loadHistory>
<scriptAsOpen>true</scriptAsOpen>
<alertCancellationScriptAsOpen>true</alertCancellationScriptAsOpen>
<logOutput>false</logOutput>
<actionStrategy>
<type>ALL</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</actionStrategy>
<timeFilter>
<intervalCount>0</intervalCount>
<intervalUnit>SECOND</intervalUnit>
</timeFilter>
<discardPreviousValues>false</discardPreviousValues>
<webNotification>
<disabled>false</disabled>
<rule-name>dockerhub-build-fail</rule-name>
<repeat-interval>
<type>ALL</type>
<intervalCount>6</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</repeat-interval>
<name>Web Service Notification id=664</name>
<use-in-threshold-only>false</use-in-threshold-only>
<first-details>false</first-details>
<repeat-details>false</repeat-details>
<cancel-details>false</cancel-details>
<first-screenshot>false</first-screenshot>
<repeat-screenshot>false</repeat-screenshot>
<cancel-screenshot>false</cancel-screenshot>
<repeat-as-open>true</repeat-as-open>
<cancel-as-open>true</cancel-as-open>
<webNotificationConfigName>dockerhub-webhook-sender</webNotificationConfigName>
<firstWebConfigParameters>
<key>build_code</key>
<value>${tags.build_code}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>cause</key>
<value>${ifEmpty(tags.cause, 'N/A')}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>created_date</key>
<value>${tags.created_date}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>current_seconds</key>
<value>${Math.round(now.getMillis()/1000L)}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>dockertag_name</key>
<value>${ifEmpty(tags.dockertag_name, 'N/A')}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>id</key>
<value>${tags.id}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>last_updated</key>
<value>${tags.last_updated}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>name</key>
<value>${tags.name}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>repository</key>
<value>${tags.repository}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>status</key>
<value>${tags.status}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>status_desc</key>
<value>${status_desc}</value>
</firstWebConfigParameters>
<firstWebConfigParameters>
<key>user</key>
<value>${tags.user}</value>
</firstWebConfigParameters>
<repeatWebConfigParameters>
<key>build_code</key>
<value>${tags.build_code}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>cause</key>
<value>${ifEmpty(tags.cause, 'N/A')}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>created_date</key>
<value>${tags.created_date}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>current_seconds</key>
<value>${Math.round(now.getMillis()/1000L)}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>dockertag_name</key>
<value>${ifEmpty(tags.dockertag_name, 'N/A')}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>id</key>
<value>${tags.id}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>last_updated</key>
<value>${tags.last_updated}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>name</key>
<value>${tags.name}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>repository</key>
<value>${tags.repository}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>status</key>
<value>${tags.status}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>status_desc</key>
<value>${status_desc}</value>
</repeatWebConfigParameters>
<repeatWebConfigParameters>
<key>user</key>
<value>${tags.user}</value>
</repeatWebConfigParameters>
<cancelWebConfigParameters>
<key>build_code</key>
<value>${tags.build_code}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>cause</key>
<value>${ifEmpty(tags.cause, 'N/A')}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>created_date</key>
<value>${tags.created_date}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>current_seconds</key>
<value>${Math.round(now.getMillis()/1000L)}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>dockertag_name</key>
<value>${ifEmpty(tags.dockertag_name, 'N/A')}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>id</key>
<value>${tags.id}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>last_updated</key>
<value>${tags.last_updated}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>name</key>
<value>${tags.name}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>repository</key>
<value>${tags.repository}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>status</key>
<value>${tags.status}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>status_desc</key>
<value>${status_desc}</value>
</cancelWebConfigParameters>
<cancelWebConfigParameters>
<key>user</key>
<value>${tags.user}</value>
</cancelWebConfigParameters>
<first-enabled>true</first-enabled>
<repeat-enabled>true</repeat-enabled>
<cancel-enabled>false</cancel-enabled>
</webNotification>
<ruleTable/>
<alertLoggerName>atsd.alert.default</alertLoggerName>
<derivedCommand>series e:${entity} m:metric_123=${100 - value} ${commandTags}</derivedCommand>
<derivedCommandEnabled>false</derivedCommandEnabled>
<derivedCommandStrategy>
<type>ALL</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</derivedCommandStrategy>
<alertOpenMessageEnabled>false</alertOpenMessageEnabled>
<alertMessageEnabled>false</alertMessageEnabled>
<alertCancellationMessageEnabled>false</alertCancellationMessageEnabled>
<alertOpenScriptEnabled>false</alertOpenScriptEnabled>
<scriptEnabled>false</scriptEnabled>
<alertCancellationScriptEnabled>false</alertCancellationScriptEnabled>
</rule>
</rules>
